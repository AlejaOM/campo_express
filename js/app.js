// Simulación de base de datos
window.tiendas = [
  {
    id: 1,
    nombre: "Verdulería Doña María",
    imagen: "./assets/fdm.jpeg", 
    coordenadas: [4.712, -74.071],
    productos:[
    { id: 1, nombre: 'Aguacate x kilo', precio: 3500, imagen: './assets/104_33.jpg' },
    { id: 2, nombre: 'Coco x kilo', precio: 2500, imagen: './assets/149_32.jpg' },
    { id: 3, nombre: 'Lulo x kilo', precio: 3000, imagen: './assets/192_32.jpg' },
    { id: 4, nombre: 'Banano x kilo', precio: 4000, imagen: './assets/226_32.jpg' },
    { id: 5, nombre: 'Tomate de arbol x kilo', precio: 3500, imagen: './assets/274_32.jpg' },
    { id: 6, nombre: 'Manzana verde x kilo', precio: 5000, imagen: './assets/353.jpg' },
    { id: 7, nombre: 'Arándanos x kilo', precio: 4500, imagen: './assets/614143340529.jpg' },
    { id: 8, nombre: 'Auyama x kilo', precio: 2000, imagen: './assets/109_33.jpg' },
    { id: 9, nombre: 'Guanabana x kilo', precio: 2500, imagen: './assets/169_32.jpg' },
    { id: 10, nombre: 'Mandarina x kilo', precio: 1800, imagen: './assets/197_32.jpg' },
    { id: 11, nombre: 'Naranja x kilo', precio: 3200, imagen: './assets/227_33.jpg' },
    { id: 12, nombre: 'Tomate x kilo', precio: 4000, imagen: './assets/275_32.jpg' },
    { id: 13, nombre: 'Manzana rosada x kilo', precio: 5000, imagen: './assets/354.jpg' },
    { id: 14, nombre: 'Zarzamora x kilo', precio: 3800, imagen: './assets/614143340512.jpg' },
    { id: 15, nombre: 'Apio en rama x kilo', precio: 4200, imagen: './assets/120_30.jpg' },
    { id: 16, nombre: 'Guayaba x kilo', precio: 4500, imagen: './assets/174_32.jpg' },
    { id: 17, nombre: 'Mango tomy x kilo', precio: 4000, imagen: './assets/204_32.jpg' },
    { id: 18, nombre: 'Naranja importada x kilo', precio: 3500, imagen: './assets/230_32.jpg' },
    { id: 19, nombre: 'Uva importada x kilo', precio: 2500, imagen: './assets/278_33.jpg' },
    { id: 20, nombre: 'Pera x kilo', precio: 2800, imagen: './assets/356.jpg' },
    { id: 22, nombre: 'Platano verde x kilo', precio: 3000, imagen: './assets/176_32.jpg' },
    { id: 23, nombre: 'Manzana importada x kilo', precio: 2500, imagen: './assets/209_32.jpg' },
    { id: 24, nombre: 'Papa criolla x kilo', precio: 3500, imagen: './assets/237_32.jpg' },
    { id: 25, nombre: 'Uva isabella x kilo', precio: 4000, imagen: './assets/280_32.jpg' },
    { id: 26, nombre: 'Ciruela x kilo', precio: 3200, imagen: './assets/357.jpg' },
    { id: 27, nombre: 'Arveja x kilo', precio: 3200, imagen: './assets/124_33.jpg' },
    { id: 28, nombre: 'Habicuela x kilo', precio: 2800, imagen: './assets/177_33.jpg' },
    { id: 29, nombre: 'Manzana roja x kilo', precio: 3000, imagen: './assets/213_32.jpg' },
    { id: 30, nombre: 'Papaya x kilo', precio: 2800, imagen: './assets/240_32.jpg' },
    { id: 31, nombre: 'Uva verde x kilo', precio: 3500, imagen: './assets/281_4.jpg' },
    { id: 32, nombre: 'Pitahaya x kilo', precio: 4200, imagen: './assets/369.jpg' },
    { id: 33, nombre: 'Lechuga crespa x kilo', precio: 2200, imagen: './assets/7700934000116.jpg' },
    { id: 34, nombre: 'Hierbabuena x kilo', precio: 2400, imagen: './assets/7707068801664.jpg' },
    { id: 35, nombre: 'Romero x kilo', precio: 3500, imagen: './assets/7707068835614.jpg' },
    { id: 36, nombre: 'Menta x kilo', precio: 3000, imagen: './assets/7707068810123.jpg' }
]

  },
  {
    id: 2,
    nombre: "Frutas Frescas La Huerta",
    imagen: "./assets/flahuerta.jpeg",
    coordenadas: [4.711, -74.072],
    productos:[
    { id: 30, nombre: 'Papaya x kilo', precio: 2800, imagen: './assets/240_32.jpg' },
    { id: 31, nombre: 'Uva verde x kilo', precio: 3500, imagen: './assets/281_4.jpg' },
    { id: 32, nombre: 'Pitahaya x kilo', precio: 4200, imagen: './assets/369.jpg' },
    { id: 33, nombre: 'Lechuga crespa x kilo', precio: 2200, imagen: './assets/7700934000116.jpg' },
    { id: 34, nombre: 'Hierbabuena x kilo', precio: 2400, imagen: './assets/7707068801664.jpg' },
    { id: 35, nombre: 'Romero x kilo', precio: 3500, imagen: './assets/7707068835614.jpg' },
    { id: 36, nombre: 'Menta x kilo', precio: 3000, imagen: './assets/7707068810123.jpg' },
    { id: 8, nombre: 'Auyama x kilo', precio: 2000, imagen: './assets/109_33.jpg' },
    { id: 9, nombre: 'Guanabana x kilo', precio: 2500, imagen: './assets/169_32.jpg' },
    { id: 10, nombre: 'Mandarina x kilo', precio: 1800, imagen: './assets/197_32.jpg' },
    { id: 11, nombre: 'Naranja x kilo', precio: 3200, imagen: './assets/227_33.jpg' },
    { id: 12, nombre: 'Tomate x kilo', precio: 4000, imagen: './assets/275_32.jpg' },
    { id: 13, nombre: 'Manzana rosada x kilo', precio: 5000, imagen: './assets/354.jpg' },
    { id: 14, nombre: 'Zarzamora x kilo', precio: 3800, imagen: './assets/614143340512.jpg' },
    { id: 15, nombre: 'Apio en rama x kilo', precio: 4200, imagen: './assets/120_30.jpg' },
    { id: 16, nombre: 'Guayaba x kilo', precio: 4500, imagen: './assets/174_32.jpg' },
    { id: 17, nombre: 'Mango tomy x kilo', precio: 4000, imagen: './assets/204_32.jpg' },
    { id: 18, nombre: 'Naranja importada x kilo', precio: 3500, imagen: './assets/230_32.jpg' },
    { id: 19, nombre: 'Uva importada x kilo', precio: 2500, imagen: './assets/278_33.jpg' },
    { id: 20, nombre: 'Pera x kilo', precio: 2800, imagen: './assets/356.jpg' },
    { id: 22, nombre: 'Platano verde x kilo', precio: 3000, imagen: './assets/176_32.jpg' },
    { id: 23, nombre: 'Manzana importada x kilo', precio: 2500, imagen: './assets/209_32.jpg' }
]

  }
];

window.usuarios = [
  { email: "admin@campoexpress.com", password: "admin123", rol: "admin" },
  { email: "user@test.com", password: "user123", rol: "user" }
];

window.carrito = JSON.parse(localStorage.getItem('carrito')) || [];

// Función para manejar imágenes rotas
function manejarImagenError(img) {
  img.onerror = function() {
    this.src = './assets/placeholder.jpg'; // Imagen por defecto
    this.alt = 'Imagen no disponible';
  };
}

// Función para verificar si las imágenes existen
function verificarImagenes() {
  console.log('Verificando imágenes...');
  window.tiendas.forEach(tienda => {
    tienda.productos.forEach(producto => {
      const img = new Image();
      img.src = producto.imagen;
      img.onload = function() {
        console.log(`✅ ${producto.nombre}: ${producto.imagen}`);
      };
      img.onerror = function() {
        console.log(`❌ ${producto.nombre}: NO SE ENCUENTRA - ${producto.imagen}`);
      };
    });
  });
}

// Ejecutar verificación al cargar
window.addEventListener('load', verificarImagenes);

// En app.js, reemplaza la función agregarAlCarrito con:
function agregarAlCarrito(producto, tiendaNombre) {
    // Esta función ahora está en carrito.js
    window.agregarAlCarrito(producto, tiendaNombre);
}